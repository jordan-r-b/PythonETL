Sub Brazil_punch()

'Setting variables to easily call on things later on'

Dim wsn As Worksheet
Set wsn = Worksheets("Sheet1")
Dim wsm As Worksheet
Set wsm = Worksheets("Sheet3")
Dim ws As Worksheet
Set ws = Worksheets("Sheet4")

Dim pos As Integer

pos = 14

Dim posb As Integer

posb = 16

Dim posc As Integer

posc = 18

Dim posd As Integer

posd = 22

Dim pose As Integer

pose = 24

Dim posf As Integer

posg = 27

'Clear out any data on the two sheets I will move data back and forth on'

wsm.Cells.Clear

ws.Cells.Clear

'**********Append text file***************'
Dim fileNameAndPath As Variant
fileNameAndPath = Application.GetOpenFilename(Title:="Select File To Be Opened")
If fileNameAndPath = False Then Exit Sub

 Dim FileName As String
 Dim FolderPath As String
 Dim FSO As Object
 Dim x As Integer
 Dim SearchForWords As Variant
 Dim SubstituteWords As Variant
 Dim Text As String
 Dim TextFile As Object
 
  'Change these arrays to word you want to find and replace
   SearchForWords = Array("0000", "that", "from")
   SubstituteWords = Array("'0000", "That", "form")
   
     Set FSO = CreateObject("Scripting.FileSystemObject")

       fileSpec = fileNameAndPath
        'Read all the file's text into a string variable.
         Set TextFile = FSO.OpenTextFile(fileSpec, 1, False)
           Text = TextFile.ReadAll
         TextFile.Close

 'Scan the string for words to replace and write the string back to the file.
         Set TextFile = FSO.OpenTextFile(fileSpec, 2, False)
           For x = 0 To UBound(SearchForWords)
             Text = Replace(Text, SearchForWords(I), SubstituteWords(I))
           Next x
         TextFile.Write Text
         
wsm.Cells.NumberFormat = "@"

'Procedure to choose a file to open and import into the sheet'

Set y = Workbooks.Open(fileNameAndPath)

'Copy data from TXT or Excel file onto first sheet of this workbook'

y.Sheets(1).Cells.Copy
wsm.Range("A1").PasteSpecial Paste:=xlPasteValues
Application.CutCopyMode = False
y.Close SaveChanges:=False

'Copy data from TXT or Excel file onto first sheet of this workbook'

'Loop down each row and getting the data into the string needed by the bank by connecting words and # and variables with &'

With wsm

For I = 1 To Rows.Count

If wsm.Cells(I, 1) <> "" Then

ws.Cells(I, 1).Value = Right((wsm.Cells(I, 1)), 11)

ws.Cells(I, 2).Value = Mid((wsm.Cells(I, 1)), posd, 2) & "/" & Mid((wsm.Cells(I, 1)), pose, 2)

ws.Cells(I, 3).Value = Mid((wsm.Cells(I, 1)), posb, 2) & "/" & Mid((wsm.Cells(I, 1)), pos, 2) & "/" _
& Mid((wsm.Cells(I, 1)), posc, 4)

End If

Next I

End With

ws.SaveAs FileName:=ThisWorkbook.Path & "\" & "PunchImport" _
& ".txt", FileFormat:=xlCSVUTF8

MsgBox "Punch Import file saved to Macro file location", vbOKOnly

End Sub
